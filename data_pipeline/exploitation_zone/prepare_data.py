import geopandas as gpd
import pandas as pd

def generate_meta_trsa_csv(input_geojson_path, output_csv_path):
    gdf = gpd.read_file(input_geojson_path)

    df = pd.DataFrame({
        "OBJECTID": gdf["reference"],  # we use the same naming convention as the original model
        "YearBuilt1": gdf["beginning"].astype(str).str[:4],  # just year
        "HEIGHT": gdf["numberOf_1"] * 3,  # Multiply by 3 to get the height in meters
        "UseDescription": gdf["currentUse"].astype(str).str[0]
    })

    df.to_csv(output_csv_path, index=False)
    return df


def generate_height_trsa_csv(input_geojson_path, output_csv_path):
    gdf = gpd.read_file(input_geojson_path)

    df = pd.DataFrame({
        "OBJECTID": gdf["reference"],  # we use the same naming convention as the original model
        "HEIGHT_norm": gdf["numberOf_1"] * 3
    })
    df.to_csv(output_csv_path, index=False)
    return df
